package com.emnify.tapfilereport;

import com.emnify.tapfilereport.pojo.TapFileRecord;
import com.fasterxml.jackson.core.JsonParseException;
import com.fasterxml.jackson.databind.JsonMappingException;
import com.fasterxml.jackson.databind.JsonNode;
import com.fasterxml.jackson.databind.ObjectMapper;

import org.apache.http.HttpEntity;
import org.apache.http.HttpHost;
import org.apache.http.entity.ContentType;
import org.apache.http.entity.StringEntity;
import org.apache.http.nio.entity.NStringEntity;
import org.apache.http.util.EntityUtils;
import org.elasticsearch.client.Response;
import org.elasticsearch.client.RestClient;

import java.io.IOException;
import java.util.Collections;
import java.util.HashMap;
import java.util.Map;

public class MainHttpClient {

  public static void main(String[] args) throws IOException {

    RestClient client = RestClient.builder(new HttpHost("34.250.31.19", 9200, "http")).build();

    // RestClient client = RestClient.builder(new HttpHost("10.100.48.20", 9200, "http")).build();

    // Response response = client.performRequest("GET", "/_cluster/health", new Hashtable<>());
    // System.out.println("Status:\n" + EntityUtils.toString(response.getEntity()));

    // response =
    // client.performRequest("GET", "/tapdata", Collections.singletonMap("pretty", "true"));
    // System.out.println("Mapping:\n" + EntityUtils.toString(response.getEntity()));


    String query = "{\"query\":{\"match\":{\"Traffic_Type\":\"Data\"}}}";

    // String query =
    // "{\"query\":{\"bool\":{\"must\":[{\"match\":{\"Traffic_Type\":\"Data\"}},{\"match\":
    // {\"Recipient\":\"BELBX\"}}]}}}";

    // String query =
    // "{\"query\": {\"bool\": {\"must\": [{\"match\": {\"Traffic_Type\": \"Data\"}}, {\"match\":
    // {\"Recipient\": \"BELOB\"}}], \"filter\": [{\"term\": {\"Traffic_Type\": \"Data\"}},
    // {\"range\": {\"CallEventStartTimeStamp_UTCTimestamp\": {\"gte\": \"20170201000000+0100\",
    // \"lte\": \"20170228595959+0100\"}}}]}}}";

    int i = 1;

    Response response =
        client.performRequest("GET", "/tapdata/_search?search_type=scan&scroll=1m",
            Collections.singletonMap("pretty", "true"), new StringEntity(query));

    String resp = EntityUtils.toString(response.getEntity());
    System.out.println("scan&scroll response:\n" + resp);

    ObjectMapper mapper = new ObjectMapper();
    JsonNode actualObj = mapper.readTree(resp);

    String scroll_id = actualObj.get("_scroll_id").asText();

    // Map<String, String> params = new HashMap<String, String>();
    // params.put("pretty", "true");
    // params.put("scroll_id", scroll_id);



    while (true) {

      Response tmp =
          client.performRequest("GET", "/_search/scroll?scroll=1m&scroll_id=" + scroll_id,
              Collections.singletonMap("pretty", "true"), new StringEntity(query));



      String resp_tmp = EntityUtils.toString(tmp.getEntity());
      System.out.println(i++ + ". Response:\n" + resp_tmp);
      JsonNode jsonNode = mapper.readTree(resp_tmp);

      scroll_id = jsonNode.get("_scroll_id").asText();
      System.out.println(i + ". scroll_id = " + scroll_id);
    }



    // client.close();
  }

  public static void test() {
    String json =
        "{\"took\":493,\"timed_out\":false,\"_shards\":{\"total\":5,\"successful\":5,\"failed\":0},\"hits\":{\"total\":7752184,\"max_score\":1.010285,\"hits\":[{\"_index\":\"tapdata\",\"_type\":\"starhome\",\"_id\":\"AVA3RF0Aat7VifUaGZxf\",\"_score\":1.010285,\"_source\":{\"Recording_Entity\":[0,2],\"Charging_Id\":4057,\"AccessPointName_OI\":\"mnc043.mcc901.gprs\",\"AccessPointName_NI\":\"EM\",\"PDP_Address\":\"10.199.1.154\",\"IMEI\":\"3568130309734390\",\"Serving_Network\":null,\"TotalCallEventDuration\":168,\"Traffic_Type\":\"Data\",\"Volume_Tx\":0.21995,\"Volume_Rx\":4.644254,\"Volume_Total\":4.864204,\"IMSI\":\"901430000000341\",\"MSISDN\":null,\"TapFileName\":\"TDAUTPTEMNDE00015\",\"File_Sequence_Number\":\"00015\",\"Sender\":\"AUTPT\",\"Recipient\":\"EMNDE\",\"LocalCurrency\":\"EUR\",\"CurrencyConversionInfo\":{\"exchangeRateCode\":0,\"exchangeRate\":125037,\"numberOfDecimalPlaces\":5},\"UTCTimeOffsetInfo\":{\"utcTimeOffset\":\"+0200\",\"utcTimeOffsetCode\":1},\"SGSN_GGSN_Info\":[{\"recEntityType\":4,\"recEntityCode\":2,\"recEntityId\":\"194.48.132.12\"},{\"recEntityCode\":1,\"recEntityId\":\"194.48.132.14\",\"recEntityType\":4},{\"recEntityId\":\"185.57.216.35\",\"recEntityCode\":0,\"recEntityType\":3}],\"AuditControlInfo\":{\"latestCallTimeStamp\":{\"utcTimeOffset\":\"+0200\",\"localTimeStamp\":\"20150916125547\"},\"totalDiscountValue\":0,\"callEventDetailsCount\":3,\"totalTaxValue\":3887,\"earliestCallTimeStamp\":{\"localTimeStamp\":\"20150915094053\",\"utcTimeOffset\":\"+0200\"},\"totalCharge\":19443},\"AccountingInfo\":{\"taxation\":[{\"taxCode\":0,\"taxType\":\"01\",\"taxRate\":2e+06}],\"tapDecimalPlaces\":5,\"localCurrency\":\"EUR\",\"currencyConversionInfo\":[{\"exchangeRateCode\":0,\"exchangeRate\":125037,\"numberOfDecimalPlaces\":5}]},\"CallEventStartTimeStamp_UTCTimestamp\":\"20150916125547+0200\",\"ChargeInformationList\":[{\"callTypeGroup\":{\"callTypeLevel3\":1,\"callTypeLevel1\":11,\"callTypeLevel2\":0},\"exchangeRateCode\":0,\"chargedItem\":\"X\",\"taxInformation\":[{\"taxableAmount\":18555,\"taxCode\":0,\"taxValue\":3711}],\"chargeDetailList\":[{\"charge\":18555,\"chargeType\":\"00\",\"chargeableUnits\":4864204}]}],\"CellID\":62114,\"Location_Area\":17007,\"CallEventStartTimeStamp_UTCOffset\":1,\"CallEventStartTimeStamp_LocalTimestamp\":\"20150916125547\"}},{\"_index\":\"tapdata\",\"_type\":\"starhome\",\"_id\":\"AVBrPqrwat7VifUaO87U\",\"_score\":1.010285,\"_source\":{\"Recording_Entity\":[5,6],\"Charging_Id\":387,\"AccessPointName_OI\":null,\"AccessPointName_NI\":\"em\",\"PDP_Address\":\"10.199.1.213\",\"IMEI\":\"0131690002414519\",\"Serving_Network\":null,\"TotalCallEventDuration\":4,\"Traffic_Type\":\"Data\",\"Volume_Tx\":0.000503,\"Volume_Rx\":0.000465,\"Volume_Total\":0.000968,\"IMSI\":\"295050999900089\",\"MSISDN\":\"423663999900089\",\"TapFileName\":\"CDCANRWEMNLI09201\",\"File_Sequence_Number\":\"09201\",\"Sender\":\"CANRW\",\"Recipient\":\"EMNLIEMK\",\"LocalCurrency\":\"USD\",\"CurrencyConversionInfo\":{\"exchangeRate\":1402740,\"exchangeRateCode\":0,\"numberOfDecimalPlaces\":6},\"UTCTimeOffsetInfo\":{\"utcTimeOffsetCode\":0,\"utcTimeOffset\":\"-0500\"},\"SGSN_GGSN_Info\":[{\"recEntityCode\":0,\"recEntityId\":\"194.48.132.218\",\"recEntityType\":3},{\"recEntityId\":\"142.146.244.33\",\"recEntityCode\":1,\"recEntityType\":4},{\"recEntityType\":4,\"recEntityId\":\"74.198.68.5\",\"recEntityCode\":2},{\"recEntityType\":1,\"recEntityId\":\"MOU\",\"recEntityCode\":3},{\"recEntityType\":1,\"recEntityCode\":4,\"recEntityId\":\"VAU\"},{\"recEntityType\":3,\"recEntityId\":\"185.57.216.35\",\"recEntityCode\":5},{\"recEntityType\":4,\"recEntityId\":\"74.198.72.162\",\"recEntityCode\":6},{\"recEntityType\":1,\"recEntityCode\":7,\"recEntityId\":\"TOU\"}],\"AuditControlInfo\":{\"totalCharge\":0,\"earliestCallTimeStamp\":{\"localTimeStamp\":\"20151012201857\",\"utcTimeOffset\":\"-0700\"},\"callEventDetailsCount\":35,\"totalTaxValue\":0,\"operatorSpecInformation\":[0,0],\"totalDiscountValue\":0,\"latestCallTimeStamp\":{\"utcTimeOffset\":\"-0700\",\"localTimeStamp\":\"20151013154318\"}},\"AccountingInfo\":{\"currencyConversionInfo\":[{\"exchangeRate\":1402740,\"exchangeRateCode\":0,\"numberOfDecimalPlaces\":6}],\"localCurrency\":\"USD\",\"tapDecimalPlaces\":4},\"CallEventStartTimeStamp_UTCTimestamp\":\"20151012201857-0500\",\"ChargeInformationList\":[{\"chargedItem\":\"X\",\"callTypeGroup\":{\"callTypeLevel2\":0,\"callTypeLevel1\":10,\"callTypeLevel3\":0},\"chargeDetailList\":[{\"chargeableUnits\":968,\"chargeType\":\"00\",\"chargedUnits\":1024,\"charge\":0}]}],\"CellID\":null,\"Location_Area\":null,\"CallEventStartTimeStamp_UTCOffset\":2,\"CallEventStartTimeStamp_LocalTimestamp\":\"20151012201857\"}},{\"_index\":\"tapdata\",\"_type\":\"starhome\",\"_id\":\"AVBrPqrwat7VifUaO87Z\",\"_score\":1.010285,\"_source\":{\"Recording_Entity\":[5,6],\"Charging_Id\":397,\"AccessPointName_OI\":null,\"AccessPointName_NI\":\"em\",\"PDP_Address\":\"10.199.1.213\",\"IMEI\":\"0131690002414519\",\"Serving_Network\":null,\"TotalCallEventDuration\":4,\"Traffic_Type\":\"Data\",\"Volume_Tx\":0.000193,\"Volume_Rx\":8.2e-05,\"Volume_Total\":0.000275,\"IMSI\":\"295050999900089\",\"MSISDN\":\"423663999900089\",\"TapFileName\":\"CDCANRWEMNLI09201\",\"File_Sequence_Number\":\"09201\",\"Sender\":\"CANRW\",\"Recipient\":\"EMNLIEMK\",\"LocalCurrency\":\"USD\",\"CurrencyConversionInfo\":{\"exchangeRate\":1402740,\"exchangeRateCode\":0,\"numberOfDecimalPlaces\":6},\"UTCTimeOffsetInfo\":{\"utcTimeOffsetCode\":0,\"utcTimeOffset\":\"-0500\"},\"SGSN_GGSN_Info\":[{\"recEntityCode\":0,\"recEntityId\":\"194.48.132.218\",\"recEntityType\":3},{\"recEntityId\":\"142.146.244.33\",\"recEntityCode\":1,\"recEntityType\":4},{\"recEntityType\":4,\"recEntityId\":\"74.198.68.5\",\"recEntityCode\":2},{\"recEntityType\":1,\"recEntityId\":\"MOU\",\"recEntityCode\":3},{\"recEntityType\":1,\"recEntityCode\":4,\"recEntityId\":\"VAU\"},{\"recEntityType\":3,\"recEntityId\":\"185.57.216.35\",\"recEntityCode\":5},{\"recEntityType\":4,\"recEntityId\":\"74.198.72.162\",\"recEntityCode\":6},{\"recEntityType\":1,\"recEntityCode\":7,\"recEntityId\":\"TOU\"}],\"AuditControlInfo\":{\"totalCharge\":0,\"earliestCallTimeStamp\":{\"localTimeStamp\":\"20151012201857\",\"utcTimeOffset\":\"-0700\"},\"callEventDetailsCount\":35,\"totalTaxValue\":0,\"operatorSpecInformation\":[0,0],\"totalDiscountValue\":0,\"latestCallTimeStamp\":{\"utcTimeOffset\":\"-0700\",\"localTimeStamp\":\"20151013154318\"}},\"AccountingInfo\":{\"currencyConversionInfo\":[{\"exchangeRate\":1402740,\"exchangeRateCode\":0,\"numberOfDecimalPlaces\":6}],\"localCurrency\":\"USD\",\"tapDecimalPlaces\":4},\"CallEventStartTimeStamp_UTCTimestamp\":\"20151012210531-0500\",\"ChargeInformationList\":[{\"chargeDetailList\":[{\"chargeableUnits\":275,\"chargeType\":\"00\",\"chargedUnits\":1024,\"charge\":0}],\"chargedItem\":\"X\",\"callTypeGroup\":{\"callTypeLevel1\":10,\"callTypeLevel3\":0,\"callTypeLevel2\":0}}],\"CellID\":null,\"Location_Area\":null,\"CallEventStartTimeStamp_UTCOffset\":2,\"CallEventStartTimeStamp_LocalTimestamp\":\"20151012210531\"}},{\"_index\":\"tapdata\",\"_type\":\"starhome\",\"_id\":\"AVBrPqrwat7VifUaO87d\",\"_score\":1.010285,\"_source\":{\"Recording_Entity\":[5,6],\"Charging_Id\":405,\"AccessPointName_OI\":null,\"AccessPointName_NI\":\"em\",\"PDP_Address\":\"10.199.1.213\",\"IMEI\":\"0131690002414519\",\"Serving_Network\":null,\"TotalCallEventDuration\":10,\"Traffic_Type\":\"Data\",\"Volume_Tx\":0.001632,\"Volume_Rx\":0.041331,\"Volume_Total\":0.042963,\"IMSI\":\"295050999900089\",\"MSISDN\":\"423663999900089\",\"TapFileName\":\"CDCANRWEMNLI09201\",\"File_Sequence_Number\":\"09201\",\"Sender\":\"CANRW\",\"Recipient\":\"EMNLIEMK\",\"LocalCurrency\":\"USD\",\"CurrencyConversionInfo\":{\"exchangeRate\":1402740,\"exchangeRateCode\":0,\"numberOfDecimalPlaces\":6},\"UTCTimeOffsetInfo\":{\"utcTimeOffsetCode\":0,\"utcTimeOffset\":\"-0500\"},\"SGSN_GGSN_Info\":[{\"recEntityCode\":0,\"recEntityId\":\"194.48.132.218\",\"recEntityType\":3},{\"recEntityId\":\"142.146.244.33\",\"recEntityCode\":1,\"recEntityType\":4},{\"recEntityType\":4,\"recEntityId\":\"74.198.68.5\",\"recEntityCode\":2},{\"recEntityType\":1,\"recEntityId\":\"MOU\",\"recEntityCode\":3},{\"recEntityType\":1,\"recEntityCode\":4,\"recEntityId\":\"VAU\"},{\"recEntityType\":3,\"recEntityId\":\"185.57.216.35\",\"recEntityCode\":5},{\"recEntityType\":4,\"recEntityId\":\"74.198.72.162\",\"recEntityCode\":6},{\"recEntityType\":1,\"recEntityCode\":7,\"recEntityId\":\"TOU\"}],\"AuditControlInfo\":{\"totalCharge\":0,\"earliestCallTimeStamp\":{\"localTimeStamp\":\"20151012201857\",\"utcTimeOffset\":\"-0700\"},\"callEventDetailsCount\":35,\"totalTaxValue\":0,\"operatorSpecInformation\":[0,0],\"totalDiscountValue\":0,\"latestCallTimeStamp\":{\"utcTimeOffset\":\"-0700\",\"localTimeStamp\":\"20151013154318\"}},\"AccountingInfo\":{\"currencyConversionInfo\":[{\"exchangeRate\":1402740,\"exchangeRateCode\":0,\"numberOfDecimalPlaces\":6}],\"localCurrency\":\"USD\",\"tapDecimalPlaces\":4},\"CallEventStartTimeStamp_UTCTimestamp\":\"20151012212624-0500\",\"ChargeInformationList\":[{\"chargeDetailList\":[{\"chargeableUnits\":42963,\"chargedUnits\":43008,\"chargeType\":\"00\",\"charge\":0}],\"callTypeGroup\":{\"callTypeLevel1\":10,\"callTypeLevel3\":0,\"callTypeLevel2\":0},\"chargedItem\":\"X\",\"exchangeRateCode\":0}],\"CellID\":null,\"Location_Area\":null,\"CallEventStartTimeStamp_UTCOffset\":2,\"CallEventStartTimeStamp_LocalTimestamp\":\"20151012212624\"}},{\"_index\":\"tapdata\",\"_type\":\"starhome\",\"_id\":\"AVBrPqrwat7VifUaO87i\",\"_score\":1.010285,\"_source\":{\"Recording_Entity\":[5,6],\"Charging_Id\":501,\"AccessPointName_OI\":null,\"AccessPointName_NI\":\"em\",\"PDP_Address\":\"10.199.1.213\",\"IMEI\":\"0131690002414519\",\"Serving_Network\":null,\"TotalCallEventDuration\":4,\"Traffic_Type\":\"Data\",\"Volume_Tx\":0.000503,\"Volume_Rx\":0.000465,\"Volume_Total\":0.000968,\"IMSI\":\"295050999900089\",\"MSISDN\":\"423663999900089\",\"TapFileName\":\"CDCANRWEMNLI09201\",\"File_Sequence_Number\":\"09201\",\"Sender\":\"CANRW\",\"Recipient\":\"EMNLIEMK\",\"LocalCurrency\":\"USD\",\"CurrencyConversionInfo\":{\"exchangeRate\":1402740,\"exchangeRateCode\":0,\"numberOfDecimalPlaces\":6},\"UTCTimeOffsetInfo\":{\"utcTimeOffsetCode\":0,\"utcTimeOffset\":\"-0500\"},\"SGSN_GGSN_Info\":[{\"recEntityCode\":0,\"recEntityId\":\"194.48.132.218\",\"recEntityType\":3},{\"recEntityId\":\"142.146.244.33\",\"recEntityCode\":1,\"recEntityType\":4},{\"recEntityType\":4,\"recEntityId\":\"74.198.68.5\",\"recEntityCode\":2},{\"recEntityType\":1,\"recEntityId\":\"MOU\",\"recEntityCode\":3},{\"recEntityType\":1,\"recEntityCode\":4,\"recEntityId\":\"VAU\"},{\"recEntityType\":3,\"recEntityId\":\"185.57.216.35\",\"recEntityCode\":5},{\"recEntityType\":4,\"recEntityId\":\"74.198.72.162\",\"recEntityCode\":6},{\"recEntityType\":1,\"recEntityCode\":7,\"recEntityId\":\"TOU\"}],\"AuditControlInfo\":{\"totalCharge\":0,\"earliestCallTimeStamp\":{\"localTimeStamp\":\"20151012201857\",\"utcTimeOffset\":\"-0700\"},\"callEventDetailsCount\":35,\"totalTaxValue\":0,\"operatorSpecInformation\":[0,0],\"totalDiscountValue\":0,\"latestCallTimeStamp\":{\"utcTimeOffset\":\"-0700\",\"localTimeStamp\":\"20151013154318\"}},\"AccountingInfo\":{\"currencyConversionInfo\":[{\"exchangeRate\":1402740,\"exchangeRateCode\":0,\"numberOfDecimalPlaces\":6}],\"localCurrency\":\"USD\",\"tapDecimalPlaces\":4},\"CallEventStartTimeStamp_UTCTimestamp\":\"20151013081001-0500\",\"ChargeInformationList\":[{\"chargeDetailList\":[{\"chargeableUnits\":968,\"chargeType\":\"00\",\"chargedUnits\":1024,\"charge\":0}],\"callTypeGroup\":{\"callTypeLevel2\":0,\"callTypeLevel3\":0,\"callTypeLevel1\":10},\"chargedItem\":\"X\"}],\"CellID\":null,\"Location_Area\":null,\"CallEventStartTimeStamp_UTCOffset\":2,\"CallEventStartTimeStamp_LocalTimestamp\":\"20151013081001\"}},{\"_index\":\"tapdata\",\"_type\":\"starhome\",\"_id\":\"AVBrPqrwat7VifUaO87n\",\"_score\":1.010285,\"_source\":{\"Recording_Entity\":[5,6],\"Charging_Id\":507,\"AccessPointName_OI\":null,\"AccessPointName_NI\":\"em\",\"PDP_Address\":\"10.199.1.213\",\"IMEI\":\"0131690002414519\",\"Serving_Network\":null,\"TotalCallEventDuration\":5,\"Traffic_Type\":\"Data\",\"Volume_Tx\":0.001632,\"Volume_Rx\":0.041331,\"Volume_Total\":0.042963,\"IMSI\":\"295050999900089\",\"MSISDN\":\"423663999900089\",\"TapFileName\":\"CDCANRWEMNLI09201\",\"File_Sequence_Number\":\"09201\",\"Sender\":\"CANRW\",\"Recipient\":\"EMNLIEMK\",\"LocalCurrency\":\"USD\",\"CurrencyConversionInfo\":{\"exchangeRate\":1402740,\"exchangeRateCode\":0,\"numberOfDecimalPlaces\":6},\"UTCTimeOffsetInfo\":{\"utcTimeOffsetCode\":0,\"utcTimeOffset\":\"-0500\"},\"SGSN_GGSN_Info\":[{\"recEntityCode\":0,\"recEntityId\":\"194.48.132.218\",\"recEntityType\":3},{\"recEntityId\":\"142.146.244.33\",\"recEntityCode\":1,\"recEntityType\":4},{\"recEntityType\":4,\"recEntityId\":\"74.198.68.5\",\"recEntityCode\":2},{\"recEntityType\":1,\"recEntityId\":\"MOU\",\"recEntityCode\":3},{\"recEntityType\":1,\"recEntityCode\":4,\"recEntityId\":\"VAU\"},{\"recEntityType\":3,\"recEntityId\":\"185.57.216.35\",\"recEntityCode\":5},{\"recEntityType\":4,\"recEntityId\":\"74.198.72.162\",\"recEntityCode\":6},{\"recEntityType\":1,\"recEntityCode\":7,\"recEntityId\":\"TOU\"}],\"AuditControlInfo\":{\"totalCharge\":0,\"earliestCallTimeStamp\":{\"localTimeStamp\":\"20151012201857\",\"utcTimeOffset\":\"-0700\"},\"callEventDetailsCount\":35,\"totalTaxValue\":0,\"operatorSpecInformation\":[0,0],\"totalDiscountValue\":0,\"latestCallTimeStamp\":{\"utcTimeOffset\":\"-0700\",\"localTimeStamp\":\"20151013154318\"}},\"AccountingInfo\":{\"currencyConversionInfo\":[{\"exchangeRate\":1402740,\"exchangeRateCode\":0,\"numberOfDecimalPlaces\":6}],\"localCurrency\":\"USD\",\"tapDecimalPlaces\":4},\"CallEventStartTimeStamp_UTCTimestamp\":\"20151013082103-0500\",\"ChargeInformationList\":[{\"exchangeRateCode\":0,\"chargeDetailList\":[{\"charge\":0,\"chargeType\":\"00\",\"chargedUnits\":43008,\"chargeableUnits\":42963}],\"callTypeGroup\":{\"callTypeLevel1\":10,\"callTypeLevel3\":0,\"callTypeLevel2\":0},\"chargedItem\":\"X\"}],\"CellID\":null,\"Location_Area\":null,\"CallEventStartTimeStamp_UTCOffset\":2,\"CallEventStartTimeStamp_LocalTimestamp\":\"20151013082103\"}},{\"_index\":\"tapdata\",\"_type\":\"starhome\",\"_id\":\"AVBrPqrwat7VifUaO87s\",\"_score\":1.010285,\"_source\":{\"Recording_Entity\":[5,6],\"Charging_Id\":513,\"AccessPointName_OI\":null,\"AccessPointName_NI\":\"em\",\"PDP_Address\":\"10.199.1.213\",\"IMEI\":\"0131690002414519\",\"Serving_Network\":null,\"TotalCallEventDuration\":3,\"Traffic_Type\":\"Data\",\"Volume_Tx\":0.000185,\"Volume_Rx\":0,\"Volume_Total\":0.000185,\"IMSI\":\"295050999900089\",\"MSISDN\":\"423663999900089\",\"TapFileName\":\"CDCANRWEMNLI09201\",\"File_Sequence_Number\":\"09201\",\"Sender\":\"CANRW\",\"Recipient\":\"EMNLIEMK\",\"LocalCurrency\":\"USD\",\"CurrencyConversionInfo\":{\"exchangeRate\":1402740,\"exchangeRateCode\":0,\"numberOfDecimalPlaces\":6},\"UTCTimeOffsetInfo\":{\"utcTimeOffsetCode\":0,\"utcTimeOffset\":\"-0500\"},\"SGSN_GGSN_Info\":[{\"recEntityCode\":0,\"recEntityId\":\"194.48.132.218\",\"recEntityType\":3},{\"recEntityId\":\"142.146.244.33\",\"recEntityCode\":1,\"recEntityType\":4},{\"recEntityType\":4,\"recEntityId\":\"74.198.68.5\",\"recEntityCode\":2},{\"recEntityType\":1,\"recEntityId\":\"MOU\",\"recEntityCode\":3},{\"recEntityType\":1,\"recEntityCode\":4,\"recEntityId\":\"VAU\"},{\"recEntityType\":3,\"recEntityId\":\"185.57.216.35\",\"recEntityCode\":5},{\"recEntityType\":4,\"recEntityId\":\"74.198.72.162\",\"recEntityCode\":6},{\"recEntityType\":1,\"recEntityCode\":7,\"recEntityId\":\"TOU\"}],\"AuditControlInfo\":{\"totalCharge\":0,\"earliestCallTimeStamp\":{\"localTimeStamp\":\"20151012201857\",\"utcTimeOffset\":\"-0700\"},\"callEventDetailsCount\":35,\"totalTaxValue\":0,\"operatorSpecInformation\":[0,0],\"totalDiscountValue\":0,\"latestCallTimeStamp\":{\"utcTimeOffset\":\"-0700\",\"localTimeStamp\":\"20151013154318\"}},\"AccountingInfo\":{\"currencyConversionInfo\":[{\"exchangeRate\":1402740,\"exchangeRateCode\":0,\"numberOfDecimalPlaces\":6}],\"localCurrency\":\"USD\",\"tapDecimalPlaces\":4},\"CallEventStartTimeStamp_UTCTimestamp\":\"20151013082820-0500\",\"ChargeInformationList\":[{\"callTypeGroup\":{\"callTypeLevel2\":0,\"callTypeLevel3\":0,\"callTypeLevel1\":10},\"chargedItem\":\"X\",\"chargeDetailList\":[{\"charge\":0,\"chargeType\":\"00\",\"chargedUnits\":1024,\"chargeableUnits\":185}]}],\"CellID\":null,\"Location_Area\":null,\"CallEventStartTimeStamp_UTCOffset\":2,\"CallEventStartTimeStamp_LocalTimestamp\":\"20151013082820\"}},{\"_index\":\"tapdata\",\"_type\":\"starhome\",\"_id\":\"AVBrPqrwat7VifUaO87x\",\"_score\":1.010285,\"_source\":{\"Recording_Entity\":[5,6],\"Charging_Id\":519,\"AccessPointName_OI\":null,\"AccessPointName_NI\":\"em\",\"PDP_Address\":\"10.199.1.213\",\"IMEI\":\"0131690002414519\",\"Serving_Network\":null,\"TotalCallEventDuration\":2,\"Traffic_Type\":\"Data\",\"Volume_Tx\":0.000187,\"Volume_Rx\":0,\"Volume_Total\":0.000187,\"IMSI\":\"295050999900089\",\"MSISDN\":\"423663999900089\",\"TapFileName\":\"CDCANRWEMNLI09201\",\"File_Sequence_Number\":\"09201\",\"Sender\":\"CANRW\",\"Recipient\":\"EMNLIEMK\",\"LocalCurrency\":\"USD\",\"CurrencyConversionInfo\":{\"exchangeRate\":1402740,\"exchangeRateCode\":0,\"numberOfDecimalPlaces\":6},\"UTCTimeOffsetInfo\":{\"utcTimeOffsetCode\":0,\"utcTimeOffset\":\"-0500\"},\"SGSN_GGSN_Info\":[{\"recEntityCode\":0,\"recEntityId\":\"194.48.132.218\",\"recEntityType\":3},{\"recEntityId\":\"142.146.244.33\",\"recEntityCode\":1,\"recEntityType\":4},{\"recEntityType\":4,\"recEntityId\":\"74.198.68.5\",\"recEntityCode\":2},{\"recEntityType\":1,\"recEntityId\":\"MOU\",\"recEntityCode\":3},{\"recEntityType\":1,\"recEntityCode\":4,\"recEntityId\":\"VAU\"},{\"recEntityType\":3,\"recEntityId\":\"185.57.216.35\",\"recEntityCode\":5},{\"recEntityType\":4,\"recEntityId\":\"74.198.72.162\",\"recEntityCode\":6},{\"recEntityType\":1,\"recEntityCode\":7,\"recEntityId\":\"TOU\"}],\"AuditControlInfo\":{\"totalCharge\":0,\"earliestCallTimeStamp\":{\"localTimeStamp\":\"20151012201857\",\"utcTimeOffset\":\"-0700\"},\"callEventDetailsCount\":35,\"totalTaxValue\":0,\"operatorSpecInformation\":[0,0],\"totalDiscountValue\":0,\"latestCallTimeStamp\":{\"utcTimeOffset\":\"-0700\",\"localTimeStamp\":\"20151013154318\"}},\"AccountingInfo\":{\"currencyConversionInfo\":[{\"exchangeRate\":1402740,\"exchangeRateCode\":0,\"numberOfDecimalPlaces\":6}],\"localCurrency\":\"USD\",\"tapDecimalPlaces\":4},\"CallEventStartTimeStamp_UTCTimestamp\":\"20151013083323-0500\",\"ChargeInformationList\":[{\"chargeDetailList\":[{\"chargeableUnits\":187,\"chargeType\":\"00\",\"chargedUnits\":1024,\"charge\":0}],\"chargedItem\":\"X\",\"callTypeGroup\":{\"callTypeLevel2\":0,\"callTypeLevel1\":10,\"callTypeLevel3\":0}}],\"CellID\":null,\"Location_Area\":null,\"CallEventStartTimeStamp_UTCOffset\":2,\"CallEventStartTimeStamp_LocalTimestamp\":\"20151013083323\"}},{\"_index\":\"tapdata\",\"_type\":\"starhome\",\"_id\":\"AVBrPqrwat7VifUaO872\",\"_score\":1.010285,\"_source\":{\"Recording_Entity\":[5,6],\"Charging_Id\":578,\"AccessPointName_OI\":null,\"AccessPointName_NI\":\"em\",\"PDP_Address\":\"10.199.1.213\",\"IMEI\":\"0131690002414519\",\"Serving_Network\":null,\"TotalCallEventDuration\":4,\"Traffic_Type\":\"Data\",\"Volume_Tx\":0.000193,\"Volume_Rx\":8.2e-05,\"Volume_Total\":0.000275,\"IMSI\":\"295050999900089\",\"MSISDN\":\"423663999900089\",\"TapFileName\":\"CDCANRWEMNLI09201\",\"File_Sequence_Number\":\"09201\",\"Sender\":\"CANRW\",\"Recipient\":\"EMNLIEMK\",\"LocalCurrency\":\"USD\",\"CurrencyConversionInfo\":{\"exchangeRate\":1402740,\"exchangeRateCode\":0,\"numberOfDecimalPlaces\":6},\"UTCTimeOffsetInfo\":{\"utcTimeOffsetCode\":0,\"utcTimeOffset\":\"-0500\"},\"SGSN_GGSN_Info\":[{\"recEntityCode\":0,\"recEntityId\":\"194.48.132.218\",\"recEntityType\":3},{\"recEntityId\":\"142.146.244.33\",\"recEntityCode\":1,\"recEntityType\":4},{\"recEntityType\":4,\"recEntityId\":\"74.198.68.5\",\"recEntityCode\":2},{\"recEntityType\":1,\"recEntityId\":\"MOU\",\"recEntityCode\":3},{\"recEntityType\":1,\"recEntityCode\":4,\"recEntityId\":\"VAU\"},{\"recEntityType\":3,\"recEntityId\":\"185.57.216.35\",\"recEntityCode\":5},{\"recEntityType\":4,\"recEntityId\":\"74.198.72.162\",\"recEntityCode\":6},{\"recEntityType\":1,\"recEntityCode\":7,\"recEntityId\":\"TOU\"}],\"AuditControlInfo\":{\"totalCharge\":0,\"earliestCallTimeStamp\":{\"localTimeStamp\":\"20151012201857\",\"utcTimeOffset\":\"-0700\"},\"callEventDetailsCount\":35,\"totalTaxValue\":0,\"operatorSpecInformation\":[0,0],\"totalDiscountValue\":0,\"latestCallTimeStamp\":{\"utcTimeOffset\":\"-0700\",\"localTimeStamp\":\"20151013154318\"}},\"AccountingInfo\":{\"currencyConversionInfo\":[{\"exchangeRate\":1402740,\"exchangeRateCode\":0,\"numberOfDecimalPlaces\":6}],\"localCurrency\":\"USD\",\"tapDecimalPlaces\":4},\"CallEventStartTimeStamp_UTCTimestamp\":\"20151013154318-0500\",\"ChargeInformationList\":[{\"chargeDetailList\":[{\"chargeableUnits\":275,\"chargeType\":\"00\",\"chargedUnits\":1024,\"charge\":0}],\"callTypeGroup\":{\"callTypeLevel2\":0,\"callTypeLevel3\":0,\"callTypeLevel1\":10},\"chargedItem\":\"X\"}],\"CellID\":null,\"Location_Area\":null,\"CallEventStartTimeStamp_UTCOffset\":2,\"CallEventStartTimeStamp_LocalTimestamp\":\"20151013154318\"}},{\"_index\":\"tapdata\",\"_type\":\"starhome\",\"_id\":\"AVBrPqtlat7VifUaO879\",\"_score\":1.010285,\"_source\":{\"Recording_Entity\":[35,3],\"Charging_Id\":647,\"AccessPointName_OI\":null,\"AccessPointName_NI\":\"em\",\"PDP_Address\":\"10.199.2.252\",\"IMEI\":\"3537480633967801\",\"Serving_Network\":null,\"TotalCallEventDuration\":7,\"Traffic_Type\":\"Data\",\"Volume_Tx\":0.001615,\"Volume_Rx\":0.005706,\"Volume_Total\":0.007321,\"IMSI\":\"295050999900075\",\"MSISDN\":null,\"TapFileName\":\"CDGBRVFEMNLI05688\",\"File_Sequence_Number\":\"05688\",\"Sender\":\"GBRVF\",\"Recipient\":\"EMNLIEMK\",\"LocalCurrency\":\"GBP\",\"CurrencyConversionInfo\":{\"exchangeRateCode\":0,\"exchangeRate\":91599,\"numberOfDecimalPlaces\":5},\"UTCTimeOffsetInfo\":{\"utcTimeOffsetCode\":0,\"utcTimeOffset\":\"+0100\"},\"SGSN_GGSN_Info\":[{\"recEntityType\":1,\"recEntityId\":\"OUSE\",\"recEntityCode\":0},{\"recEntityId\":\"194.48.132.218\",\"recEntityCode\":1,\"recEntityType\":3},{\"recEntityId\":\"212.183.144.252\",\"recEntityCode\":2,\"recEntityType\":4},{\"recEntityType\":4,\"recEntityId\":\"212.183.144.249\",\"recEntityCode\":3},{\"recEntityCode\":4,\"recEntityId\":\"212.183.144.245\",\"recEntityType\":4},{\"recEntityCode\":5,\"recEntityId\":\"212.183.144.250\",\"recEntityType\":4},{\"recEntityId\":\"212.183.144.243\",\"recEntityCode\":6,\"recEntityType\":4},{\"recEntityId\":\"212.183.144.247\",\"recEntityCode\":7,\"recEntityType\":4},{\"recEntityType\":4,\"recEntityId\":\"212.183.144.248\",\"recEntityCode\":8},{\"recEntityId\":\"212.183.144.244\",\"recEntityCode\":9,\"recEntityType\":4},{\"recEntityCode\":10,\"recEntityId\":\"212.183.144.246\",\"recEntityType\":4},{\"recEntityId\":\"BEULT\",\"recEntityCode\":11,\"recEntityType\":1},{\"recEntityCode\":12,\"recEntityId\":\"S0\",\"recEntityType\":1},{\"recEntityId\":\"PANG\",\"recEntityCode\":13,\"recEntityType\":1},{\"recEntityCode\":14,\"recEntityId\":\"DERWENT\",\"recEntityType\":1},{\"recEntityId\":\"COLNE\",\"recEntityCode\":15,\"recEntityType\":1},{\"recEntityType\":1,\"recEntityCode\":16,\"recEntityId\":\"BR\"},{\"recEntityCode\":17,\"recEntityId\":\"LOSTOCKMSCBC\",\"recEntityType\":1},{\"recEntityType\":1,\"recEntityId\":\"BREDE\",\"recEntityCode\":18},{\"recEntityCode\":19,\"recEntityId\":\"TRENTMSCBC\",\"recEntityType\":1},{\"recEntityType\":1,\"recEntityId\":\"HAMBLE\",\"recEntityCode\":20},{\"recEntityId\":\"ITCHEN\",\"recEntityCode\":21,\"recEntityType\":1},{\"recEntityType\":1,\"recEntityId\":\"FLEET\",\"recEntityCode\":22},{\"recEntityId\":\"LONGFORD\",\"recEntityCode\":23,\"recEntityType\":1},{\"recEntityType\":1,\"recEntityCode\":24,\"recEntityId\":\"THAMES\"},{\"recEntityType\":1,\"recEntityId\":\"MILTONKEYNES\",\"recEntityCode\":25},{\"recEntityType\":1,\"recEntityCode\":26,\"recEntityId\":\"FROME\"},{\"recEntityId\":\"IRWELL\",\"recEntityCode\":27,\"recEntityType\":1},{\"recEntityType\":1,\"recEntityCode\":28,\"recEntityId\":\"BASINGSTOKE3\"},{\"recEntityType\":1,\"recEntityId\":\"B4\",\"recEntityCode\":29},{\"recEntityCode\":30,\"recEntityId\":\"CROAL\",\"recEntityType\":1},{\"recEntityType\":1,\"recEntityCode\":31,\"recEntityId\":\"ARROW\"},{\"recEntityType\":1,\"recEntityId\":\"S2\",\"recEntityCode\":32},{\"recEntityType\":1,\"recEntityCode\":33,\"recEntityId\":\"B3\"},{\"recEntityCode\":34,\"recEntityId\":\"R0\",\"recEntityType\":1},{\"recEntityCode\":35,\"recEntityId\":\"185.57.216.35\",\"recEntityType\":3},{\"recEntityType\":1,\"recEntityId\":\"REGENT\",\"recEntityCode\":36},{\"recEntityCode\":37,\"recEntityId\":\"BASINGSTOKEMMSC\",\"recEntityType\":1},{\"recEntityType\":1,\"recEntityId\":\"C0\",\"recEntityCode\":38},{\"recEntityCode\":39,\"recEntityId\":\"TAME\",\"recEntityType\":1},{\"recEntityId\":\"194.48.132.214\",\"recEntityCode\":40,\"recEntityType\":3},{\"recEntityType\":1,\"recEntityCode\":41,\"recEntityId\":\"CHELMER\"},{\"recEntityType\":3,\"recEntityCode\":42,\"recEntityId\":\"194.48.132.215\"},{\"recEntityId\":\"USK\",\"recEntityCode\":43,\"recEntityType\":1},{\"recEntityId\":\"C2\",\"recEntityCode\":44,\"recEntityType\":1}],\"AuditControlInfo\":{\"totalTaxValue\":0,\"earliestCallTimeStamp\":{\"utcTimeOffset\":\"+0100\",\"localTimeStamp\":\"20151013235529\"},\"latestCallTimeStamp\":{\"localTimeStamp\":\"20151014143810\",\"utcTimeOffset\":\"+0100\"},\"callEventDetailsCount\":10,\"totalCharge\":0,\"totalDiscountValue\":0,\"operatorSpecInformation\":[\"ACIgeneratedbySVR*FSH\"]},\"AccountingInfo\":{\"localCurrency\":\"GBP\",\"currencyConversionInfo\":[{\"exchangeRateCode\":0,\"exchangeRate\":91599,\"numberOfDecimalPlaces\":5}],\"tapDecimalPlaces\":3},\"CallEventStartTimeStamp_UTCTimestamp\":\"20151014095729+0100\",\"ChargeInformationList\":[{\"chargeDetailList\":[{\"charge\":0,\"chargeableUnits\":7321,\"chargeType\":\"00\"}],\"callTypeGroup\":{\"callTypeLevel2\":0,\"callTypeLevel1\":10,\"callTypeLevel3\":0},\"exchangeRateCode\":0,\"chargedItem\":\"X\"}],\"CellID\":null,\"Location_Area\":140,\"CallEventStartTimeStamp_UTCOffset\":0,\"CallEventStartTimeStamp_LocalTimestamp\":\"20151014095729\"}}]}}";

    ObjectMapper mapper = new ObjectMapper();
    try {
      TapFileRecord tfr = mapper.readValue(json, TapFileRecord.class);
      System.err.println(tfr.toString());
    } catch (JsonParseException e) {
      e.printStackTrace();
    } catch (JsonMappingException e) {
      e.printStackTrace();
    } catch (IOException e) {
      e.printStackTrace();
    }

  }

}


